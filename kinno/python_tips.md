# Python tips

はえ〜ってなったtipsを書いていきます．基本的にバージョンは3.5以上です．

## Python実行後にkilled: 9と表示される

Pythonスクリプトがメモリリークを起こしていることが原因である．  
発生箇所を特定して，省メモリになるように変更を加えるか，明示的なメモリ開放を行う必要がある．

### 方法1 巨大なシーケンシャルデータはジェネレータとして扱う

巨大なデータを一度に読み出すとメモリを異常に圧迫してしまう．対象データをジェネレータとして扱うことで，データを一度にメモリに確保しなくなるので省メモリで実行できる．

### 方法2 明示的にメモリを開放する

本来はガベージコレクタという機能によって不要なオブジェクトが占有しているメモリは自動で開放されるが，まれにオブジェクトがメモリに残り続けることがある．Graphillionがその最たる例で，直前の操作で発生した未開放のメモリが現在の操作に影響を及ぼしてしまう場合がある．こういった場合には明示的なメモリ開放を行うことでkilled: 9のエラーを回避できる（かもしれない）．  

明示的なメモリ解放には`gc`モジュールを使用する．

```python
import gc

del obj # 削除したいオブジェクトを指定する
gc.collect()
```

## ブレークポイントを設置する

ブレークポイントを設置することで実行を途中で止めてプログラムの様子を詳細に確認できるようになる．  
ブレークポイントの設置には`pdb`モジュールを使用する．

```python
import pdb

print("before break point")
pdb.set_trace() # ここで一旦プログラムが止まる
print("after break point")
```

`pdb.set_trace()`が呼ばれるとデバッガモードが起動しプロンプトに`(pdb)`と表示される．  
デバッガモード時にコマンドを入力することで様々な操作を行うことができる．
